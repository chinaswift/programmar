/*!
 * --------------------------------------------------------------------
 *  SIMPLE TEXT SELECTION LIBRARY FOR ONLINE TEXT EDITING (2015-02-21)
 * --------------------------------------------------------------------
 * Source code available at https://github.com/tovic/simple-text-editor-library
 *
 */
var Editor=function(e){var t=this,a=document,n=[],l=0,r=null;t.area=void 0!==e?e:a.getElementsByTagName("textarea")[0],n[l]={value:t.area.value,selectionStart:0,selectionEnd:0},l++,t.selection=function(){var e=t.area.selectionStart,a=t.area.selectionEnd,n=t.area.value.substring(e,a),l=t.area.value.substring(0,e),r=t.area.value.substring(a),o={start:e,end:a,value:n,before:l,after:r};return o},t.select=function(e,n,l){var r=[a.documentElement.scrollTop,a.body.scrollTop,t.area.scrollTop];t.area.focus(),t.area.setSelectionRange(e,n),a.documentElement.scrollTop=r[0],a.body.scrollTop=r[1],t.area.scrollTop=r[2],"function"==typeof l&&l()},t.replace=function(e,a,n){var l=t.selection(),r=l.start,o=(l.end,l.value.replace(e,a));t.area.value=l.before+o+l.after,t.select(r,r+o.length),"function"==typeof n?n():t.updateHistory({value:t.area.value,selectionStart:r,selectionEnd:r+o.length})},t.insert=function(e,a){var n=t.selection(),l=n.start;n.end,t.area.value=n.before+e+n.after,t.select(l+e.length,l+e.length),"function"==typeof a?a():t.updateHistory({value:t.area.value,selectionStart:l+e.length,selectionEnd:l+e.length})},t.wrap=function(e,a,n){var l=t.selection(),r=l.value,o=l.before,c=l.after;t.area.value=o+e+r+a+c,t.select(o.length+e.length,o.length+e.length+r.length),"function"==typeof n?n():t.updateHistory({value:t.area.value,selectionStart:o.length+e.length,selectionEnd:o.length+e.length+r.length})},t.indent=function(e,a){var n=t.selection();n.value.length>0?t.replace(/(^|\n)([^\n])/gm,"$1"+e+"$2",a):(t.area.value=n.before+e+n.value+n.after,t.select(n.start+e.length,n.start+e.length),"function"==typeof a?a():t.updateHistory({value:t.area.value,selectionStart:n.start+e.length,selectionEnd:n.start+e.length}))},t.outdent=function(e,a){var n=t.selection();if(n.value.length>0)t.replace(RegExp("(^|\n)"+e,"gm"),"$1",a);else{var l=n.before.replace(RegExp(e+"$"),"");t.area.value=l+n.value+n.after,t.select(l.length,l.length),"function"==typeof a?a():t.updateHistory({value:t.area.value,selectionStart:l.length,selectionEnd:l.length})}},t.callHistory=function(e){return"number"==typeof e?n[e]:n},t.updateHistory=function(e,a){var r=void 0!==e?e:{value:t.area.value,selectionStart:t.selection().start,selectionEnd:t.selection().end};n["number"==typeof a?a:l]=r,l++},t.undo=function(e){if(n.length>1){l>1?l--:l=1;var a=t.callHistory(l-1);r=l>0?l:l-1,t.area.value=a.value,t.select(a.selectionStart,a.selectionEnd),"function"==typeof e&&e()}},t.redo=function(e){if(null!==r){var a=t.callHistory(r);r<n.length-1?r++:r=n.length-1,l=r<n.length-1?r:r+1,t.area.value=a.value,t.select(a.selectionStart,a.selectionEnd),"function"==typeof e&&e()}}};